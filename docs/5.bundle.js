(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{225:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(12),i=a.n(c),o=a(22),s=a(41),l=a(78),u=a(73),f=function(e){var t=e.currentCity;return n.a.createElement("div",{className:"cities__places-container cities__places-container--empty container"},n.a.createElement("section",{className:"cities__no-places"},n.a.createElement("div",{className:"cities__status-wrapper tabs__content"},n.a.createElement("b",{className:"cities__status"},"No places to stay available"),n.a.createElement("p",{className:"cities__status-description"},"We could not find any property available at the moment in"," ",t))),n.a.createElement("div",{className:"cities__right-section"}))},p=a(23),m=a(5),d=function(e){var t=e.sortType,a=e.name,r=e.onSelectOption,c=e.isSelected,i=Object(o.c)();return n.a.createElement("li",{className:"".concat(c&&"places__option--active"," places__option"),onKeyPress:function(e){e.key===m.b.ENTER&&(r(t,a),i(p.a.setSortType(t)))},onClick:function(){r(t,a),i(p.a.setSortType(t))},tabIndex:0,"data-value":t},a)};d.propTypes={sortType:i.a.string.isRequired,name:i.a.string.isRequired,onSelectOption:i.a.func.isRequired,isSelected:i.a.bool.isRequired};var y=d;function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,c=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var v=function(){var e=_(Object(r.useState)(!1),2),t=e[0],a=e[1],c=_(Object(r.useState)("popular"),2),i=c[0],o=c[1],s=_(Object(r.useState)("Popular"),2),l=s[0],u=s[1],f=Object(r.useRef)(),p=Object(r.useRef)();Object(r.useEffect)((function(){return window.addEventListener("click",d),function(){return window.removeEventListener("click",d)}}),[t]);var d=function(e){var r=f.current.contains(e.target),n=p.current.contains(e.target);!t||r||n||a(!1)},h=function(e,t){a(!1),o(e),u(t)};return n.a.createElement("div",{className:"places__sorting",action:"#",method:"get"},n.a.createElement("span",{className:"places__sorting-caption"},"Sort by "),n.a.createElement("span",{type:"button",className:"places__sorting-type",onClick:function(){a((function(e){return!e}))},onKeyPress:function(e){e.key===m.b.ENTER&&a((function(e){return!e}))},tabIndex:0,ref:p},l,n.a.createElement("svg",{className:"places__sorting-arrow",width:"7",height:"4"},n.a.createElement("use",{xlinkHref:"#icon-arrow-select"}))),n.a.createElement("ul",{onKeyDown:function(e){e.key===m.b.ESCAPE&&a(!1)},ref:f,className:"".concat(t&&"places__options--opened"," places__options places__options--custom"),tabIndex:-1},m.c.map((function(e){return n.a.createElement(y,{onSelectOption:h,isSelected:i===e.isSelected,sortType:e.sortType,name:e.name,button:p,key:e.sortType})}))))},b=a(79),E=function(e){var t=e.city,a=e.currentCity,r=e.changeCity;return n.a.createElement("li",{className:"locations__item"},n.a.createElement("a",{className:"locations__item-link tabs__item ".concat(a===t?"tabs__item--active":""),onClick:function(e){e.preventDefault(),r(t)},tabIndex:0,onKeyPress:function(e){e.preventDefault(),e.key===m.b.ENTER&&r(t)}},n.a.createElement("span",null,t)))};E.propTypes={city:i.a.string.isRequired,changeCity:i.a.func.isRequired,currentCity:i.a.string.isRequired};var g=E,O=a(80),N=function(){var e=Object(o.c)(),t=Object(o.d)(s.f),a=Object(o.d)(s.a),r=function(t){e(p.a.setCity(t))};return n.a.createElement("section",{className:"locations container"},n.a.createElement("ul",{className:"locations__list tabs__list"},t.map((function(e){return n.a.createElement(g,{key:O.generate(),city:e,changeCity:r,currentCity:a})}))))};function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=A(e);if(t){var n=A(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return S(this,a)}}function S(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C,P,I,M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(i,e);var t,a,r,c=T(i);function i(){return w(this,i),c.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.currentCity,a=e.offers;return n.a.createElement("div",{className:"page page--gray page--main"},n.a.createElement(u.a,null),n.a.createElement("main",{className:"page__main page__main--index"},n.a.createElement("h1",{className:"visually-hidden"},"Cities"),n.a.createElement("div",{className:"tabs"},n.a.createElement(N,null)),n.a.createElement("div",{className:"cities"},a.length?n.a.createElement("div",{className:"cities__places-container container"},n.a.createElement("section",{className:"cities__places places"},n.a.createElement("h2",{className:"visually-hidden"},"Places"),n.a.createElement("b",{className:"places__found"},a.length," places to stay in ",t),n.a.createElement(v,null),n.a.createElement(b.a,{offers:a,classModOffers:["cities__places-list","tabs__content"],classModPrefix:"cities",mainClassMod:"cities__place-card"})),n.a.createElement("div",{className:"cities__right-section"},n.a.createElement("section",{className:"cities__map map"},n.a.createElement(l.a,{offers:a})))):n.a.createElement(f,{currentCity:t}))))}}])&&k(t.prototype,a),r&&k(t,r),i}(r.PureComponent);C=M,P="propTypes",I={offers:i.a.array.isRequired,currentCity:i.a.string.isRequired},P in C?Object.defineProperty(C,P,{value:I,enumerable:!0,configurable:!0,writable:!0}):C[P]=I;var q=Object(o.b)((function(e){return{currentCity:Object(s.a)(e),offers:Object(s.e)(e)}}))(M);t.default=q},72:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n}));var r=function(e){return e.user.isAuthorizationRequired},n=function(e){return e.user.loginData}},73:function(e,t,a){"use strict";var r=a(0),n=a.n(r),c=a(70),i=a(40),o=a(22),s=a(5),l=a(72),u=a(24),f=function(){var e=Object(o.d)(l.b),t=Object(o.d)(l.a),a=Object(o.c)(),r=Object(c.g)(),f=t?n.a.createElement("span",{className:"header__login",onClick:function(){a(u.a.requiredAuthorization(!0)),r.push(s.a.LOGIN_PATH)},tabIndex:0,onKeyPress:function(e){e.key===s.b.ENTER&&(a(u.a.requiredAuthorization(!0)),r.push("/login"))}},"Sign in"):n.a.createElement("span",{className:"header__user-name user__name"},e.email);return n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"header__wrapper"},n.a.createElement("div",{className:"header__left"},n.a.createElement(i.a,{to:"/",className:"header__logo-link header__logo-link--active"},n.a.createElement("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"}))),n.a.createElement("nav",{className:"header__nav"},n.a.createElement("ul",{className:"header__nav-list"},n.a.createElement("li",{className:"header__nav-item user"},n.a.createElement(i.a,{to:t?"/login":"/favorites",className:"header__nav-link header__nav-link--profile"},n.a.createElement("div",{className:"header__avatar-wrapper user__avatar-wrapper",style:e.avatarUrl&&{backgroundImage:"url(".concat(s.a.BASE_URL).concat(e.avatarUrl,")")}}),f)))))))};t.a=f},74:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(2),n=a(5),c=a(11),i=function(e){return{type:r.a.LOAD_FAVORITES,payload:e}},o=function(e){return{type:r.a.UPDATE_FAVORITES,payload:e}},s={loadFavorites:function(){return function(e,t,a){return a.get(n.a.FAVORITE_PATH).then((function(e){return Object(c.d)(e)})).then((function(t){return e(i(t))}))}},updateFavorites:function(e,t){return function(a,r,i){return i.post("".concat(n.a.FAVORITE_PATH,"/").concat(e,"/").concat(+!t)).then((function(e){return Object(c.c)(e)})).then((function(e){return a(o(e))}))}}}},75:function(e,t,a){"use strict";var r=a(0),n=a.n(r),c=a(22),i=a(12),o=a.n(i),s=a(5),l=a(15),u=a(23),f=a(74),p=a(72),m=function(e){var t=e.isFavorite,a=e.prefixClass,r=e.width,i=e.height,o=e.id,m=e.match,d=Object(c.c)(),y=Object(c.d)(p.a),_=function(e){var t=e.params.id;switch(e.path){case"/":return void d(u.b.loadOffers());case"/offer/:id":return d(u.b.loadNearbyOffers(t)),void d(u.b.loadOffers());case"/favorites":return void d(f.a.loadFavorites())}};return n.a.createElement("button",{type:"button",className:"".concat(a,"__bookmark-button ").concat(!y&&t?"place-card__bookmark-button--active":""," button"),"aria-pressed":t?"true":"false",onClick:function(){y?l.a.push(s.a.LOGIN_PATH):function(e,t,a){d(f.a.updateFavorites(e,t)),_(a,e)}(o,t,m)}},n.a.createElement("svg",{className:"place-card__bookmark-icon","aria-hidden":"true",width:r,height:i},n.a.createElement("use",{xlinkHref:"#icon-bookmark"})),n.a.createElement("span",{className:"visually-hidden"},t?"In":"To"," bookmarks"))};m.propTypes={id:o.a.number.isRequired,match:o.a.object.isRequired,isFavorite:o.a.bool.isRequired,prefixClass:o.a.string.isRequired,width:o.a.number.isRequired,height:o.a.number.isRequired};var d=m;t.a=d},76:function(e,t,a){"use strict";var r=a(0),n=a.n(r),c=a(12),i=a.n(c),o=a(40),s=a(70),l=a(75),u=a(5),f=function(e){var t=e.offerDetails,a=t.title,r=t.id,c=t.previewPhoto,i=t.isPremium,s=t.isFavorite,f=t.price,p=t.type,m=t.rating,d=e.mainClassMod,y=void 0===d?"":d,_=e.classModPrefix,h=void 0===_?"":_,v=e.selectOffer,b=e.match,E=function(){"/"===b.path&&v(r)},g=function(){"/offer/:id"===b.path&&v(r)};return n.a.createElement("article",{className:"".concat(y," place-card")},i?n.a.createElement("div",{className:"place-card__mark"},n.a.createElement("span",null,"Premium")):null,n.a.createElement("div",{className:"".concat(h,"__image-wrapper place-card__image-wrapper"),onClick:g,onMouseEnter:E},n.a.createElement("button",{type:"button"},n.a.createElement(o.a,{to:"/offer/".concat(r)},n.a.createElement("img",{className:"place-card__image",src:c,width:"".concat("/favorites"===b.path?"150":"260"),height:"".concat("/favorites"===b.path?"110":"200"),alt:a})))),n.a.createElement("div",{className:"".concat(h,"__card-info place-card__info")},n.a.createElement("div",{className:"place-card__price-wrapper"},n.a.createElement("div",{className:"place-card__price"},n.a.createElement("b",{className:"place-card__price-value"},"€",f),n.a.createElement("span",{className:"place-card__price-text"},"/ night")),n.a.createElement(l.a,{id:r,isFavorite:s,prefixClass:"place-card",width:18,height:19,match:b})),n.a.createElement("div",{className:"place-card__rating rating"},n.a.createElement("div",{className:"place-card__stars rating__stars"},n.a.createElement("span",{style:{width:"".concat(100*m/u.a.MAX_RATING,"%")}}),n.a.createElement("span",{className:"visually-hidden"},"Rating"))),n.a.createElement("h2",{className:"place-card__name",onClick:g,onMouseEnter:E},n.a.createElement(o.a,{to:"/offer/".concat(r)},a)),n.a.createElement("p",{className:"place-card__type"},p)))};f.propTypes={offerDetails:i.a.object.isRequired,match:i.a.object.isRequired,classModPrefix:i.a.string.isRequired,mainClassMod:i.a.string.isRequired,selectOffer:i.a.func};var p=Object(s.h)(f);t.a=p},78:function(e,t,a){"use strict";var r=a(0),n=a.n(r),c=a(12),i=a.n(c),o=a(214),s=a.n(o),l=a(22),u=a(41);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,c=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw c}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=E(e);if(t){var n=E(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return v(this,a)}}function v(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O={ID:"map",MARKER_PATH:"img/pin.svg",ACTIVE_MARKER_PATH:"img/pin-active.svg",MARKER_SIZE:[30,30],TITLE_LAYER:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"},N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(i,e);var t,a,r,c=h(i);function i(){var e;d(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return g(b(e=c.call.apply(c,[this].concat(a))),"coordinates",e.props.offers.map((function(e){return e.place.coords}))),g(b(e),"city",e.props.offers[0].city),g(b(e),"group",null),g(b(e),"icon",s.a.icon({iconUrl:O.MARKER_PATH,iconSize:O.MARKER_SIZE})),g(b(e),"activeIcon",s.a.icon({iconUrl:O.ACTIVE_MARKER_PATH,iconSize:O.MARKER_SIZE})),e}return t=i,(a=[{key:"addMarkers",value:function(){this.group=s.a.layerGroup().addTo(this.map);var e,t=p(this.coordinates);try{for(t.s();!(e=t.n()).done;){var a=e.value;s.a.marker(a,{icon:this.icon}).addTo(this.group)}}catch(e){t.e(e)}finally{t.f()}s.a.marker(this.props.currentOfferCoords,{icon:this.activeIcon}).addTo(this.group)}},{key:"initMap",value:function(){this.map=s.a.map(O.ID,{center:this.city.coords,zoom:this.city.zoom,zoomControl:!1,marker:!0,scrollWheelZoom:!1}),this.map.setView(this.city.coords,this.city.zoom),s.a.tileLayer(O.TITLE_LAYER).addTo(this.map),this.addMarkers()}},{key:"componentDidMount",value:function(){this.initMap()}},{key:"componentDidUpdate",value:function(){this.city=this.props.offers[0].city,this.coordinates=this.props.offers.map((function(e){return e.place.coords})),this.group.clearLayers(),this.map.setView(this.city.coords,this.city.zoom);var e,t=p(this.coordinates);try{for(t.s();!(e=t.n()).done;){var a=e.value;s.a.marker(a,{icon:this.icon}).addTo(this.group)}}catch(e){t.e(e)}finally{t.f()}s.a.marker(this.props.currentOfferCoords,{icon:this.activeIcon}).addTo(this.group)}},{key:"render",value:function(){return n.a.createElement("div",{style:{width:"100%",height:"100%"},className:"cities__map",id:"map"})}}])&&y(t.prototype,a),r&&y(t,r),i}(r.PureComponent);g(N,"propTypes",{offers:i.a.array.isRequired,currentOfferCoords:i.a.array.isRequired}),g(N,"defaultProps",{offers:[]});var R=Object(l.b)((function(e){return{currentOfferCoords:Object(u.b)(e)}}))(N);t.a=R},79:function(e,t,a){"use strict";var r=a(0),n=a.n(r),c=a(22),i=a(12),o=a.n(i),s=a(76),l=a(23),u=function(e){var t=e.classModPrefix,a=e.offers,r=e.mainClassMod,i=e.classModOffers,o=Object(c.c)(),u=function(e){o(l.a.setCurrentOffer(e))},f=a.map((function(e){return n.a.createElement(s.a,{key:e.id,offerDetails:e,selectOffer:u,classModPrefix:t,mainClassMod:r})}));return n.a.createElement("div",{className:"".concat(i.join(" ")," places__list ")},f)};u.propTypes={classModPrefix:o.a.string.isRequired,offers:o.a.array.isRequired,classModOffers:o.a.array.isRequired,mainClassMod:o.a.string.isRequired};var f=u;t.a=f}}]);